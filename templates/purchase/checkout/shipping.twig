{% extends 'purchase/_layouts/checkout' %}
{% block content %}

    <div class="flex flex-col-reverse md:flex-row -mx-8">
        <div class="md:w-1/3 px-8 border-l border-grey-lighter">
            {% include "purchase/_includes/order-review" with { showShippingAddress: true } %}
        </div>
        <div class="md:w-2/3 px-8">
            <h1>{{'Lieferart' | t }}</h1>

            {#
                            <div class="address-card">
                              <h3 class="label mt-0">Shipping To</h3>
                              {% if cart.shippingAddress %} {% include
                              'shop/_includes/addresses/address' with {'address': cart.shippingAddress}
                              %} {% else %}
                              <p>No shipping address selected.</p>
                              {% endif %} {% if currentUser %}<a
                                class="edit"
                                href="{{ url('purchase/checkout/addresses') }}"
                                >Edit</a
                              >{% endif %}
                            </div>
                            #}
            {# Choosing a shipping method. Now that we know the cart's address, we
                            need to show all available shipping methods. Only those that match at least
                            one rule contained in the shipping method are compatible with the order.
                            `cart.shippingMethods` only returns methods available to the order. If you
                            require shipping and no methods are avaialable, create a catch all rule in a
                            method that matches all addresses. #}
            {% if cart.getAvailableShippingMethodOptions|length < 2 and cart.shippingMethod %}
                {% redirect 'purchase/checkout/payment' %}
            {% endif %}
            {% if not cart.getAvailableShippingMethodOptions|length %}
                <p>No shipping methods available.</p>
                <p></p>
                <p>
                    <a class="button button-primary" href="{{ url('purchase/checkout/payment') }}">Continue to payment</a>
                </p>
            {% endif %}
            {% if cart.getAvailableShippingMethodOptions|length %}
                <form method="post" class="csrf">
                    {{ csrfInput() }}
                    <input type="hidden" name="action" value="commerce/cart/update-cart"/>
                    {{ redirectInput("purchase/checkout/payment") }}

                    {% for handle, method in cart.getAvailableShippingMethodOptions %}
                        <div class="shipping-select">
                            <label>
                                <input type="radio" name="shippingMethodHandle" value="{{ handle }}" {% if handle == cart.shippingMethodHandle %} checked {% endif %}/>
                                <strong>{{ method.name }}</strong>

                                <span class="price">
                                    {{ method.priceForOrder(cart)|commerceCurrency(cart.currency) }}
                                </span>
                            </label>
                        </div>
                    {% endfor %}
                    <span class="flash">{{ cart.getErrors("shippingMethod") | join }}</span>

                    <div class="orderButtons">
                        {% include "purchase/_includes/cartBackBtn" %}
                        <button class="btn btnPrimary commenceBuy" type="submit">{{ 'Weiter zur Bezahlung' | t }}</button>
                    </div>
                </form>
            {% endif %}
        </div>
    </div>

{% endblock %}
